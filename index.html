<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="./img/favicon.png">
    <title>Presente</title>
    <link rel="stylesheet" href="style.css" />
    <!-- Agregar CSS de Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="fondo-clases">
    <h2>Clases</h2>

    <div class="contenedor-tarjetas">
        <!-- Las tarjetas se generar√°n aqu√≠ din√°micamente -->
    </div>

    <a href="CrearClase.html">
        <button class="btn-nueva-clase">+ NUEVA CLASE</button>
    </a>

    <!-- Modal de confirmaci√≥n Bootstrap -->
    <div class="modal fade" id="modalConfirmarEliminar" tabindex="-1" aria-labelledby="modalEliminarLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEliminarLabel">Confirmar eliminaci√≥n</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    ¬øEst√° seguro que desea eliminar esta clase?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="btnConfirmarEliminar">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle (incluye Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const contenedor = document.querySelector('.contenedor-tarjetas');
            let clases = JSON.parse(localStorage.getItem('clases')) || [];
            let idAEliminar = null;

            function renderClases() {
                contenedor.innerHTML = '';
                clases.forEach(clase => {
                    const tarjeta = document.createElement('div');
                    tarjeta.className = 'tarjeta-clase';
                    tarjeta.innerHTML = `
                        <p><strong>${clase.nombre}</strong><br />${clase.curso}</p>
                        <div class="acciones-clase">
                            <a href="tomarAsistencia.html?claseId=${clase.id}">
                                <button>Tomar asistencia</button>
                            </a>
                            <a href="registros.html?claseId=${clase.id}">
                                <button>Registros anteriores</button>
                            </a>
                        </div>
                        <a href="CrearClase.html?editar=${clase.id}" class="configurar-clase">
                            <img src="./img/config-icon.png" alt="Configurar" />
                        </a>
                        <button class="btn-eliminar-clase" title="Eliminar clase" data-id="${clase.id}">üóëÔ∏è</button>
                    `;
                    contenedor.appendChild(tarjeta);
                });

                // Asignar evento a los botones de eliminar
                document.querySelectorAll('.btn-eliminar-clase').forEach(btn => {
                    btn.addEventListener('click', function () {
                        idAEliminar = this.getAttribute('data-id');
                        const modal = new bootstrap.Modal(document.getElementById('modalConfirmarEliminar'));
                        modal.show();
                    });
                });
            }

            // Confirmar eliminaci√≥n
            document.getElementById('btnConfirmarEliminar').addEventListener('click', function () {
                if (idAEliminar !== null) {
                    clases = clases.filter(c => c.id != idAEliminar);
                    localStorage.setItem('clases', JSON.stringify(clases));
                    renderClases();
                    idAEliminar = null;
                    const modal = bootstrap.Modal.getInstance(document.getElementById('modalConfirmarEliminar'));
                    modal.hide();
                }
            });

            renderClases();
        });
    </script>
</body>

</html>